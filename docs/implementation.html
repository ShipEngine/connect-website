<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Implementing Your Application&#x27;s Methods | ShipEngine Connect</title><meta content="utf-8" http-equiv="encoding"/><meta content="text/html;charset=utf-8" http-equiv="Content-Type"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="robots" content="noindex, nofollow"/><meta name="st:robots" content="follow, index"/><link rel="canonical" href="https://connect.shipengine.com/docs/implementation"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@ShipEngineAPI"/><meta name="twitter:creator" content="@ShipEngineAPI"/><meta name="twitter:title" content="Implementing Your Application&#x27;s Methods"/><meta name="twitter:url" content="https://connect.shipengine.com/docs/implementation"/><meta name="twitter:image" content="https://connect.shipengine.com/img/media/card-square.png"/><meta name="twitter:description" content="Learn some tips for implementing your applications methods and mapping your applications&#x27;s services to what ShipEngine Connect expects"/><meta property="og:locale" content="en_US"/><meta property="og:site_name" name="author" content="ShipEngine Connect"/><meta property="og:url" content="https://connect.shipengine.com/docs/implementation"/><meta property="og:title" name="title" content="Implementing Your Application&#x27;s Methods" class="swiftype" data-type="string"/><meta property="og:image" name="image" content="https://connect.shipengine.com/img/media/card-square.png" class="swiftype" data-type="enum"/><meta property="og:description" name="description" content="Learn some tips for implementing your applications methods and mapping your applications&#x27;s services to what ShipEngine Connect expects" class="swiftype" data-type="text"/><meta property="og:type" content="article"/><meta property="article:section" content="documentation"/><meta property="article:published_time" name="published_at" content="2022-05-23T20:34:23.538Z" class="swiftype" data-type="date"/><meta property="article:modified_time" name="updated_at" content="2022-05-23T20:34:23.538Z" class="swiftype" data-type="date"/><script type="application/ld+json">[{"@context":"http://schema.org","@type":["Service","WebAPI"],"name":"ShipEngine Connect","serviceType":"API","category":"Internet Service > API","url":"https://connect.shipengine.com/","image":"https://connect.shipengine.com/img/media/card-square.png","logo":"https://connect.shipengine.com/img/logos/shipengine-connect-logo.png","documentation":{"@context":"http://schema.org","@type":"APIReference","name":"ShipEngine Connect","headline":"ShipEngine Connect","description":"Integrate your carrier or marketplace with our world class e-commerce solutions and gain immediate access to a global user base","keywords":"","url":"https://connect.shipengine.com/docs","image":"https://connect.shipengine.com/img/media/card-square.png","isAccessibleForFree":true,"targetPlatform":"http","dateCreated":"2022-05-23T20:34:23.538Z","dateModified":"2022-05-23T20:34:23.538Z","author":{"@type":"Organization","name":"ShipEngine","telephone":"1 (512) 856-5379","email":"connect@shipengine.com","url":"https://connect.shipengine.com/","logo":"https://connect.shipengine.com/img/logos/shipengine-connect-logo.png"}},"termsOfService":"https://connect.shipengine.com/terms-of-service","description":"Learn some tips for implementing your applications methods and mapping your applications's services to what ShipEngine Connect expects","provider":{"@type":"Organization","name":"ShipEngine","telephone":"1 (512) 856-5379","email":"connect@shipengine.com","url":"https://connect.shipengine.com/","logo":"https://connect.shipengine.com/img/logos/shipengine-connect-logo.png"}},{"@context":"http://schema.org","@type":"APIReference","name":"ShipEngine Connect","headline":"Implementing Your Application's Methods","description":"Learn some tips for implementing your applications methods and mapping your applications's services to what ShipEngine Connect expects","keywords":"","url":"https://connect.shipengine.com/docs/implementation","image":"https://connect.shipengine.com/img/media/card-square.png","isAccessibleForFree":true,"targetPlatform":"NodeJS","dateCreated":"2022-05-23T20:34:23.538Z","dateModified":"2022-05-23T20:34:23.538Z","author":{"@type":"Organization","name":"ShipEngine","telephone":"1 (512) 856-5379","email":"connect@shipengine.com","url":"https://connect.shipengine.com/","logo":"https://connect.shipengine.com/img/logos/shipengine-connect-logo.png"}}]</script><link rel="icon" type="image/png" sizes="32x32" href="/img/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/img/favicons/favicon-16x16.png"/><link rel="apple-touch-icon" sizes="180x180" href="/img/favicons/apple-touch-icon-180x180.png"/><link rel="apple-touch-icon" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152.png"/><link rel="apple-touch-icon" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120.png"/><link rel="apple-touch-icon" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76.png"/><link rel="apple-touch-icon" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60.png"/><link rel="mask-icon" href="/img/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="apple-mobile-web-app-title" content="ShipEngine Connect"/><meta name="application-name" content="ShipEngine Connect"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/img/favicons/mstile-144x144.png"/><meta name="msapplication-config" content="/browserconfig.xml"/><meta name="theme-color" content="#ffffff"/><link rel="manifest" href="/site.webmanifest"/><script>!function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t,e){var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src="https://cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a);analytics._loadOptions=e};analytics.SNIPPET_VERSION="4.1.0";analytics.load("ftxwmcSBxfMQgHFM29qNvegJAqbsZq3v");analytics.page();}}();</script><meta name="next-head-count" content="11"/><link rel="preload" href="/_next/static/css/88fb68d5c7be720d2136.css" as="style"/><link rel="stylesheet" href="/_next/static/css/88fb68d5c7be720d2136.css" data-n-g=""/><link rel="preload" href="/_next/static/css/2be9a053c247fdc0bad2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2be9a053c247fdc0bad2.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-d3c771ab8682f4a400d6.js" defer=""></script><script src="/_next/static/chunks/framework-8734539471b7f505b80a.js" defer=""></script><script src="/_next/static/chunks/main-6ed46873283eb77e5b5e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-86d1a3ee013cef61a780.js" defer=""></script><script src="/_next/static/chunks/1783-13d2558ec0f4d8acaf5f.js" defer=""></script><script src="/_next/static/chunks/pages/docs/implementation-91e10f3838723024413d.js" defer=""></script><script src="/_next/static/YFMKh3E4H0mCisCl0fgei/_buildManifest.js" defer=""></script><script src="/_next/static/YFMKh3E4H0mCisCl0fgei/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="header_siteHeader__Z1OM-"><a id="site-logo" class="header_siteLogo__3_PHa" href="/"><img src="/img/logos/shipengine-connect-logo.svg" alt="Shipengine Connect"/></a><form class="header_siteSearchForm__2un1A invisible" method="get" action="https://www.google.com/search"><label for="site-search" class="visually-hidden">ShipEngine Connect Docs Search</label><input type="search" id="site-search" class="st-default-search-input" name="q" placeholder="Search"/><input type="hidden" name="as_sitesearch" value="connect.shipengine.com"/></form></header><div id="page-background"><div id="docs-page"><nav class="menu_menu__2EBQr"><button id="menu-button" class="menu_menuButton__1OMOw"></button><ul class="menu_menuList__1rqjy nav-menu "><li><details class="menu_group__1Tyby" open=""><summary>Start Here</summary><ul class="menu_groupList__QhMIb"><li><div class="menu_subGroup__1cqMy ">Overview</div><ul class="menu_subGroupList__3gBaa"><li><a class="menu_menuItem__26A3z " href="/">Welcome</a></li><li><a class="menu_menuItem__26A3z " href="/docs">Getting Started</a></li><li><a class="menu_menuItem__26A3z " href="/docs/structure">App Structure</a></li><li><a class="menu_menuItem__26A3z " href="/docs/tools">Recommended Tools</a></li></ul></li><li><div class="menu_subGroup__1cqMy menu_selected__TJy72">Guides</div><ul class="menu_subGroupList__3gBaa"><li><a class="menu_menuItem__26A3z " href="/docs/contributing">Contribution Guide</a></li><li><a class="menu_menuItem__26A3z " href="/docs/style">Style Guide</a></li><li><a class="menu_menuItem__26A3z " href="/docs/cli">Using the CLI</a></li><li><a class="menu_menuItem__26A3z " href="/docs/create-first-app">Creating Your First App</a></li><li><a class="menu_menuItem__26A3z menu_selected__TJy72" href="/docs/implementation">Implementing Your Methods</a></li><li><a class="menu_menuItem__26A3z " href="/docs/typescript">Developing in TypeScript</a></li><li><a class="menu_menuItem__26A3z " href="/docs/environment-variables">Environment Variables</a></li><li><a class="menu_menuItem__26A3z " href="/docs/error-handling">Error Handling</a></li><li><a class="menu_menuItem__26A3z " href="/docs/testing">Testing</a></li><li><a class="menu_menuItem__26A3z " href="/docs/publish">Publishing</a></li></ul></li><li><div class="menu_subGroup__1cqMy ">Reference</div><ul class="menu_subGroupList__3gBaa"><li><a class="menu_menuItem__26A3z " href="/changelog">Changelog</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/forms">Form Definitions</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/transaction">Carrier App Transaction</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/order-transaction">Order App Transaction</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/address">Address</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/common-types">Common Types</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/country-codes">Country Codes</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/shipping-preferences">Shipping Preference</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/charge">Charge</a></li></ul></li></ul></details></li><li><details class="menu_group__1Tyby" open=""><summary>Carrier Apps</summary><ul class="menu_groupList__QhMIb"><li><div class="menu_subGroup__1cqMy ">Overview</div><ul class="menu_subGroupList__3gBaa"><li><a class="menu_menuItem__26A3z " href="/docs/carrier-app">Overview</a></li><li><a class="menu_menuItem__26A3z " href="/docs/carrier-app/map-services">How to map services</a></li></ul></li><li><div class="menu_subGroup__1cqMy ">App Structure</div><ul class="menu_subGroupList__3gBaa"><li><a class="menu_menuItem__26A3z " href="/docs/reference/carrier">Carrier App</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/delivery-service">Delivery Service</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/pickup-service">Pickup Service</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/packaging">Packaging</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/delivery-confirmation">Delivery Confirmation</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/forms">Form Definitions</a></li></ul></li><li><div class="menu_subGroup__1cqMy ">Methods</div><ul class="menu_subGroupList__3gBaa"><li><a class="menu_menuItem__26A3z " href="/docs/reference/methods/connect">connect</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/methods/create-shipment">createShipment</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/methods/cancel-shipments">cancelShipments</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/methods/track-shipment">trackShipment</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/methods/rate-shipment">rateShipment</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/methods/create-manifest">createManifest</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/methods/schedule-pickup">schedulePickup</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/methods/cancel-pickups">cancelPickups</a></li></ul></li></ul></details></li><li><details class="menu_group__1Tyby"><summary>Order Apps</summary><ul class="menu_groupList__QhMIb"><li><div class="menu_subGroup__1cqMy ">Overview</div><ul class="menu_subGroupList__3gBaa"><li><a class="menu_menuItem__26A3z " href="/docs/order-app">Overview</a></li><li><a class="menu_menuItem__26A3z " href="/docs/oauth">Authorization</a></li></ul></li><li><div class="menu_subGroup__1cqMy ">App Structure</div><ul class="menu_subGroupList__3gBaa"><li><a class="menu_menuItem__26A3z " href="/docs/reference/order">Order App</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/forms#order-apps">Form Definitions</a></li></ul></li><li><div class="menu_subGroup__1cqMy ">Methods</div><ul class="menu_subGroupList__3gBaa"><li><a class="menu_menuItem__26A3z " href="/docs/reference/methods/get-sales-orders-by-date">getSalesOrdersByDate</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/methods/shipment-created">shipmentCreated</a></li><li><a class="menu_menuItem__26A3z " href="/docs/reference/methods/acknowledge-orders">acknowledgeOrders</a></li></ul></li></ul></details></li><li><details class="menu_group__1Tyby" open=""><summary>Service</summary><ul class="menu_groupList__QhMIb"><li><a class="menu_menuItem__26A3z " href="https://help.shipengine.com/">FAQ</a></li><li><a class="menu_menuItem__26A3z " href="https://help.shipengine.com/hc/en-us/requests/new">Support</a></li><li><a class="menu_menuItem__26A3z " href="https://status.shipengine.com/">API Status</a></li><li><a class="menu_menuItem__26A3z " href="https://www.shipengine.com/terms-of-service/">Terms of Service</a></li><li><a class="menu_menuItem__26A3z " href="https://www.shipengine.com/privacy-policy/">Privacy Policy</a></li></ul></details></li><li><details class="menu_group__1Tyby" open=""><summary>Community</summary><ul class="menu_groupList__QhMIb"><li><a class="menu_menuItem__26A3z " href="https://www.shipengine.com/blog/">Blog</a></li><li><a class="menu_menuItem__26A3z " href="https://www.meetup.com/Austin-Homegrown-API/">Meetup Group</a></li></ul></details></li></ul></nav><main data-swiftype-name="body" data-swiftype-type="text"><article><div class="section"><div class="section-group left-group"><h1 class="html_h1__3_ac7 ">Implementing Your Methods</h1><p>The purpose of developing a <a href="/docs">ShipEngine Connect</a> application is to provide a communication layer between your backend API or service and our
suite of e-commerce solutions where end users can utilize your services. You will provide the integration with your backend API or service when you implement the
methods generated by the <a href="/docs/cli#initialize-a-new-app"><code>connect init</code>command</a>.</p><p>Every ShipEngine Connect application provides methods that correspond to the services offered through the API or service with which you are integrating.
During the course of your application development, you will likely need to map data from your
data model to match what ShipEngine Connect expects. Your method will receive data from ShipEngine Connect that it will then need to transform into
the required format before passing it along to the backend service or API. Likewise, your backend API or service will return data that will then need to be transformed
into the format expected by ShipEngine Connect before returning it from the method.</p><p>Each method will generally have the following structure and flow:</p><ol><li>Validate the incoming information from ShipEngine Connect.</li><li>Map the data passed to your method by ShipEngine Connect to the data structure needed by the backend API or service for which your application provides the integration.</li><li>Call the the backend API or service for which your application provides the integration.</li><li>Map the response from your backend API or service to the data structure expected by ShipEngine Connect and return it from the method.</li></ol><h2 class="html_h2__RJd8Q "><span id="example" class="html_headingAnchor__2mM-B" aria-hidden="true"></span>Example<a href="#example" class="html_headingAnchorLink__1Q-xX" aria-hidden="true"></a></h2><p>Let&#x27;s look at an example implementation of the <a href="/docs/reference/methods/create-shipment">createShipment method</a>.</p><p>The following block of code shows the method taking a <code>shipment</code> argument, which is a <a href="/docs/reference/methods/create-shipment#parameters">NewShipment</a> object, and does the following:</p><ol><li>Transforms the data passed to the method by ShipEngine Connect into the structure expected by the backend API. For example, the backend API we are calling expects a property called <code>confirmation_code</code>.
We extract this value from the <code>package.deliveryConfirmation.code</code> property of the <code>shipment</code> object that was passed to this method from ShipEngine Connect.</li><li>Calls the backend API or service. In this example, we are calling a REST API for a carrier service and passing the <code>data</code> object we created in step 1.</li><li>Takes the response from the backend API and calls the <code>formatShipment</code> method to transform the carrier&#x27;s label creation response into the format that ShipEngine Connect expects. For example, ShipEngine Connect requires
the return object to contain a property called <code>trackingNumber</code> which we extract from the <code>tracking_number</code> property of the <code>response</code> object returned from the backend API call performed in step 2.</li></ol><div class="code-wrapper_codeWrapper__ssrf6"><pre class="language-typescript code-wrapper_selectedCodeBlock__ISwuh code-block_pre__2tvH1"><code class="code-block_codeBlock__18cdI"><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="1"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token maybe-class-name">NewShipment</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token maybe-class-name">ShipmentConfirmation</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token maybe-class-name">Transaction</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&quot;@shipengine/connect&quot;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="2"></span><span class="token plain"></span><span class="token doc-comment comment"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="3"></span><span class="token doc-comment comment">/**</span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="4"></span><span class="token doc-comment comment"> * Generates a shipping label and tracking number for a shipment</span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="5"></span><span class="token doc-comment comment"> */</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="6"></span><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> </span><span class="token keyword">async</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">createShipment</span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="7"></span><span class="token plain">  </span><span class="token parameter">transaction</span><span class="token parameter punctuation">:</span><span class="token parameter"> Transaction</span><span class="token parameter operator">&lt;</span><span class="token parameter">Session</span><span class="token parameter operator">&gt;</span><span class="token parameter punctuation">,</span><span class="token parameter"> shipment</span><span class="token parameter punctuation">:</span><span class="token parameter"> NewShipment</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token operator">&lt;</span><span class="token maybe-class-name">ShipmentConfirmation</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="8"></span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="9"></span><span class="token plain">  </span><span class="token comment">// STEP 1: Create the data that the carrier&#x27;s API expects</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="10"></span><span class="token plain">  </span><span class="token keyword">let</span><span class="token plain"> data</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token maybe-class-name">GenerateLabelRequest</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="11"></span><span class="token plain">    operation</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;generate_label&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="12"></span><span class="token plain">    session_id</span><span class="token punctuation">:</span><span class="token plain"> transaction</span><span class="token punctuation">.</span><span class="token property-access">session</span><span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="13"></span><span class="token plain">    service_code</span><span class="token punctuation">:</span><span class="token plain"> shipment</span><span class="token punctuation">.</span><span class="token property-access">deliveryService</span><span class="token punctuation">.</span><span class="token property-access">code</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="14"></span><span class="token plain">    confirmation_code</span><span class="token punctuation">:</span><span class="token plain"> shipment</span><span class="token punctuation">.</span><span class="token property-access">deliveryConfirmation</span><span class="token punctuation">.</span><span class="token property-access">code</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="15"></span><span class="token plain">    ship_date</span><span class="token punctuation">:</span><span class="token plain"> shipment</span><span class="token punctuation">.</span><span class="token property-access">shipDateTime</span><span class="token punctuation">.</span><span class="token method function property-access">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="16"></span><span class="token plain">    from_zone</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token plain">shipment</span><span class="token punctuation">.</span><span class="token property-access">shipFrom</span><span class="token punctuation">.</span><span class="token property-access">postalCode</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="17"></span><span class="token plain">    to_zone</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token plain">shipment</span><span class="token punctuation">.</span><span class="token property-access">shipTo</span><span class="token punctuation">.</span><span class="token property-access">postalCode</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="18"></span><span class="token plain">    total_weight</span><span class="token punctuation">:</span><span class="token plain"> shipment</span><span class="token punctuation">.</span><span class="token keyword">package</span><span class="token punctuation">.</span><span class="token property-access">weight</span><span class="token punctuation">.</span><span class="token property-access">ounces</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="19"></span><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="20"></span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="21"></span><span class="token plain">  </span><span class="token comment">// STEP 2: Call the carrier&#x27;s API</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="22"></span><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> response </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">await</span><span class="token plain"> apiClient</span><span class="token punctuation">.</span><span class="token property-access">request</span><span class="token operator">&lt;</span><span class="token maybe-class-name">GenerateLabelResponse</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> data </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="23"></span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="24"></span><span class="token plain">  </span><span class="token comment">// STEP 3: Create the output data that ShipEngine expects</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="25"></span><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token function">formatShipment</span><span class="token punctuation">(</span><span class="token plain">response</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="26"></span><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="27"></span><span class="token plain"></span><span class="token doc-comment comment"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="28"></span><span class="token doc-comment comment">/**</span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="29"></span><span class="token doc-comment comment"> * Formats a shipment in the way ShipEngine expects</span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="30"></span><span class="token doc-comment comment"> */</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="31"></span><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">formatShipment</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token parameter punctuation">:</span><span class="token parameter"> GenerateLabelResponse</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token maybe-class-name">ShipmentConfirmation</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="32"></span><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="33"></span><span class="token plain">    trackingNumber</span><span class="token punctuation">:</span><span class="token plain"> response</span><span class="token punctuation">.</span><span class="token property-access">tracking_number</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="34"></span><span class="token plain">    deliveryDateTime</span><span class="token punctuation">:</span><span class="token plain"> response</span><span class="token punctuation">.</span><span class="token property-access">delivery_date</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="35"></span><span class="token plain">    charges</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="36"></span><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="37"></span><span class="token plain">        </span><span class="token keyword">type</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token maybe-class-name">ChargeType</span><span class="token punctuation">.</span><span class="token property-access maybe-class-name">Shipping</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="38"></span><span class="token plain">        amount</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="39"></span><span class="token plain">          value</span><span class="token punctuation">:</span><span class="token plain"> response</span><span class="token punctuation">.</span><span class="token property-access">shipment_cost</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="40"></span><span class="token plain">          currency</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="41"></span><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="42"></span><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="43"></span><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="44"></span><span class="token plain">        </span><span class="token keyword">type</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token maybe-class-name">ChargeType</span><span class="token punctuation">.</span><span class="token property-access maybe-class-name">DeliveryConfirmation</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="45"></span><span class="token plain">        amount</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="46"></span><span class="token plain">          value</span><span class="token punctuation">:</span><span class="token plain"> response</span><span class="token punctuation">.</span><span class="token property-access">confirmation_cost</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="47"></span><span class="token plain">          currency</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="48"></span><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="49"></span><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="50"></span><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="51"></span><span class="token plain">        </span><span class="token keyword">type</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token maybe-class-name">ChargeType</span><span class="token punctuation">.</span><span class="token property-access maybe-class-name">LocationFee</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="52"></span><span class="token plain">        amount</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="53"></span><span class="token plain">          value</span><span class="token punctuation">:</span><span class="token plain"> response</span><span class="token punctuation">.</span><span class="token property-access">location_cost</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="54"></span><span class="token plain">          currency</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="55"></span><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="56"></span><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="57"></span><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="58"></span><span class="token plain">    packages</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="59"></span><span class="token plain">      trackingNumber</span><span class="token punctuation">:</span><span class="token plain"> response</span><span class="token punctuation">.</span><span class="token property-access">tracking_number</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="60"></span><span class="token plain">      documents</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="61"></span><span class="token plain">        </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="62"></span><span class="token plain">          name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;Shipping Label&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="63"></span><span class="token plain">          </span><span class="token keyword">type</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token maybe-class-name">DocumentType</span><span class="token punctuation">.</span><span class="token property-access maybe-class-name">Label</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="64"></span><span class="token plain">          size</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token maybe-class-name">DocumentSize</span><span class="token punctuation">.</span><span class="token property-access maybe-class-name">Inches4x6</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="65"></span><span class="token plain">          format</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token maybe-class-name">DocumentFormat</span><span class="token punctuation">.</span><span class="token constant">PDF</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="66"></span><span class="token plain">          data</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token maybe-class-name">Buffer</span><span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token plain">response</span><span class="token punctuation">.</span><span class="token property-access">image</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;base64&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="67"></span><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="68"></span><span class="token plain">      </span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="69"></span><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="70"></span><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="71"></span><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div></code></pre><pre class="language-javascript code-wrapper_codeBlock__lj1ex code-block_pre__2tvH1"><code class="code-block_codeBlock__18cdI"><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="1"></span><span class="token doc-comment comment">/**</span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="2"></span><span class="token doc-comment comment"> * Generates a shipping label and tracking number for a shipment</span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="3"></span><span class="token doc-comment comment"> */</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="4"></span><span class="token plain"></span><span class="token keyword">async</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">createShipment</span><span class="token punctuation">(</span><span class="token parameter">transaction</span><span class="token parameter punctuation">,</span><span class="token parameter"> shipment</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="5"></span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="6"></span><span class="token plain">  </span><span class="token comment">// STEP 1: Create the data that the carrier&#x27;s API expects</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="7"></span><span class="token plain">  </span><span class="token keyword">let</span><span class="token plain"> data </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="8"></span><span class="token plain">    operation</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;generate_label&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="9"></span><span class="token plain">    session_id</span><span class="token punctuation">:</span><span class="token plain"> transaction</span><span class="token punctuation">.</span><span class="token property-access">session</span><span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="10"></span><span class="token plain">    service_code</span><span class="token punctuation">:</span><span class="token plain"> shipment</span><span class="token punctuation">.</span><span class="token property-access">deliveryService</span><span class="token punctuation">.</span><span class="token property-access">code</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="11"></span><span class="token plain">    confirmation_code</span><span class="token punctuation">:</span><span class="token plain"> shipment</span><span class="token punctuation">.</span><span class="token property-access">deliveryConfirmation</span><span class="token punctuation">.</span><span class="token property-access">code</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="12"></span><span class="token plain">    ship_date</span><span class="token punctuation">:</span><span class="token plain"> shipment</span><span class="token punctuation">.</span><span class="token property-access">shipDateTime</span><span class="token punctuation">.</span><span class="token method function property-access">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="13"></span><span class="token plain">    from_zone</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token plain">shipment</span><span class="token punctuation">.</span><span class="token property-access">shipFrom</span><span class="token punctuation">.</span><span class="token property-access">postalCode</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="14"></span><span class="token plain">    to_zone</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token plain">shipment</span><span class="token punctuation">.</span><span class="token property-access">shipTo</span><span class="token punctuation">.</span><span class="token property-access">postalCode</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="15"></span><span class="token plain">    total_weight</span><span class="token punctuation">:</span><span class="token plain"> shipment</span><span class="token punctuation">.</span><span class="token property-access">package</span><span class="token punctuation">.</span><span class="token property-access">weight</span><span class="token punctuation">.</span><span class="token property-access">ounces</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="16"></span><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="17"></span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="18"></span><span class="token plain">  </span><span class="token comment">// STEP 2: Call the carrier&#x27;s API</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="19"></span><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> response </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">await</span><span class="token plain"> apiClient</span><span class="token punctuation">.</span><span class="token method function property-access">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> data </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="20"></span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="21"></span><span class="token plain">  </span><span class="token comment">// STEP 3: Create the output data that ShipEngine expects</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="22"></span><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token keyword">await</span><span class="token plain"> </span><span class="token function">formatShipment</span><span class="token punctuation">(</span><span class="token plain">response</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="23"></span><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="24"></span><span class="token plain"></span><span class="token doc-comment comment"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="25"></span><span class="token doc-comment comment">/**</span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="26"></span><span class="token doc-comment comment"> * Formats a shipment in the way ShipEngine expects</span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="27"></span><span class="token doc-comment comment"> */</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="28"></span><span class="token plain"></span><span class="token keyword">async</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">formatShipment</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="29"></span><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="30"></span><span class="token plain">    trackingNumber</span><span class="token punctuation">:</span><span class="token plain"> response</span><span class="token punctuation">.</span><span class="token property-access">tracking_number</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="31"></span><span class="token plain">    deliveryDateTime</span><span class="token punctuation">:</span><span class="token plain"> response</span><span class="token punctuation">.</span><span class="token property-access">delivery_date</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="32"></span><span class="token plain">    charges</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="33"></span><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="34"></span><span class="token plain">        type</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;shipping&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="35"></span><span class="token plain">        amount</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="36"></span><span class="token plain">          value</span><span class="token punctuation">:</span><span class="token plain"> response</span><span class="token punctuation">.</span><span class="token property-access">shipment_cost</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="37"></span><span class="token plain">          currency</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;USD&quot;</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="38"></span><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="39"></span><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="40"></span><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="41"></span><span class="token plain">        type</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;delivery_confirmation&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="42"></span><span class="token plain">        amount</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="43"></span><span class="token plain">          value</span><span class="token punctuation">:</span><span class="token plain"> response</span><span class="token punctuation">.</span><span class="token property-access">confirmation_cost</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="44"></span><span class="token plain">          currency</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;USD&quot;</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="45"></span><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="46"></span><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="47"></span><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="48"></span><span class="token plain">        type</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;location_fee&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="49"></span><span class="token plain">        amount</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="50"></span><span class="token plain">          value</span><span class="token punctuation">:</span><span class="token plain"> response</span><span class="token punctuation">.</span><span class="token property-access">location_cost</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="51"></span><span class="token plain">          currency</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;USD&quot;</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="52"></span><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="53"></span><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="54"></span><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="55"></span><span class="token plain">    packages</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="56"></span><span class="token plain">      trackingNumber</span><span class="token punctuation">:</span><span class="token plain"> response</span><span class="token punctuation">.</span><span class="token property-access">tracking_number</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="57"></span><span class="token plain">      documents</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="58"></span><span class="token plain">        </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="59"></span><span class="token plain">          name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;Label&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="60"></span><span class="token plain">          type</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;label&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="61"></span><span class="token plain">          size</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;letter&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="62"></span><span class="token plain">          data</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">await</span><span class="token plain"> </span><span class="token function">downloadLabel</span><span class="token punctuation">(</span><span class="token plain">response</span><span class="token punctuation">.</span><span class="token property-access">image_url</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="63"></span><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="64"></span><span class="token plain">      </span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="65"></span><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="66"></span><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="67"></span><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="68"></span><span class="token plain"></span><span class="token doc-comment comment"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="69"></span><span class="token doc-comment comment">/**</span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="70"></span><span class="token doc-comment comment"> * Downloads a label image</span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="71"></span><span class="token doc-comment comment"> */</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="72"></span><span class="token plain"></span><span class="token keyword">async</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">downloadLabel</span><span class="token punctuation">(</span><span class="token parameter">imageUrl</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="73"></span><span class="token plain">  </span><span class="token keyword">let</span><span class="token plain"> response </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">await</span><span class="token plain"> axios</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token plain">imageUrl</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="74"></span><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token maybe-class-name">Buffer</span><span class="token punctuation">.</span><span class="token keyword module">from</span><span class="token punctuation">(</span><span class="token plain">response</span><span class="token punctuation">.</span><span class="token property-access">data</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="line_line__3fO_7 "><span class="line_lineNumber__trKSL" data-line-number="75"></span><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div></code></pre><form class="invisible code-toolbar_codeToolbar__2r1kC"><button class="button-small">Copy</button><span class="select language-list_languageList__3_g6S language-list_typescript__1WIoa select_select__2imJS " role="listbox" tabindex="0"><span class="select-label select_selectLabel__2aKYc">typescript</span><span class="select-options select_selectOptions__1F77G "><div class="language-list_language__3ZpVE language-list_javascript__1RPTJ select_option__3vGSw" role="option" aria-selected="false" tabindex="0" data-value="javascript">JavaScript</div><div class="language-list_language__3ZpVE language-list_typescript__1WIoa select_option__3vGSw" role="option" aria-selected="true" tabindex="0" data-value="typescript">TypeScript</div></span></span></form></div><div class="pager_pager__2aTfW"><a class="button button-small button-secondary" href="/docs/create-first-app">Previous: Creating Your First App</a><a class="button button-small button-secondary" href="/docs/typescript">Next: Developing in TypeScript</a></div></div><div class="section-group right-group"><nav id="table-of-contents" class="table-of-contents_toc__2VPfA"><a href="#">Implementing Your Methods</a><a href="#example">Example</a></nav></div></div></article></main></div></div><footer class="footer_siteFooter__ugPCM"><div class="centered-content"><nav class="footer_footerNav__2pDuj"><div class="footer_column__21zWj"><div class="footer_columnHeading__RUP2K">Products</div><ul><li><a href="https://www.shipengine.com/shipping/">Shipping</a></li></ul><div class="footer_columnHeading__RUP2K">Pricing</div><ul><li><a href="https://www.shipengine.com/pricing/">Plans</a></li></ul></div><div class="footer_column__21zWj"><div class="footer_columnHeading__RUP2K">Solutions</div><ul><li><a href="https://www.shipengine.com/e-commerce-platforms/">E-commerce Platforms</a></li><li><a href="https://www.shipengine.com/third-party-logistics/">Third Party Logistics</a></li><li><a href="https://www.shipengine.com/brands/">Brands</a></li></ul><div class="footer_columnHeading__RUP2K">Integrations</div><ul><li><a href="https://www.shipengine.com/integrations/carriers/">Carriers</a></li><li><a href="https://www.shipengine.com/integrations/marketplaces/">Marketplaces</a></li></ul></div><div class="footer_column__21zWj"><div class="footer_columnHeading__RUP2K">Developers</div><ul><li><a href="https://www.shipengine.com/docs/">Documentation</a></li><li><a href="https://status.shipengine.com/">API Status</a></li></ul></div><div class="footer_column__21zWj"><div class="footer_columnHeading__RUP2K">Company</div><ul><li><a href="https://www.shipengine.com/about/">About</a></li><li><a href="https://www.shipengine.com/customers/">Customers</a></li><li><a href="https://www.shipengine.com/blog/">Blog</a></li><li><a href="https://www.shipengine.com/contact/">Contact</a></li><li><a href="https://help.shipengine.com/">Support</a></li><li><a href="https://gear.shipengine.com/">ShipEngine Gear Shop</a></li><li><a href="https://www.shipengine.com/privacy-policy/">Privacy Policy</a></li><li><a href="https://www.shipengine.com/terms-of-service/">Terms of Service</a></li></ul></div><div class="footer_socialMediaIcons__1UaL_"><div class="heading visually-hidden">Social Media</div><ul><li><a href="https://www.instagram.com/shipengineapi/" class="footer_instagram__HpTyY"><span class="visually-hidden">ShipEngine on Instagram</span></a></li><li><a href="https://www.facebook.com/ShipEngineAPI/" class="footer_facebook__3HupI"><span class="visually-hidden">ShipEngine on Facebook</span></a></li><li><a href="https://twitter.com/ShipEngineAPI" class="footer_twitter__I4Q8B"><span class="visually-hidden">ShipEngine on Twitter</span></a></li><li><a href="https://www.linkedin.com/company/shipengine/" class="footer_linkedin__2R042"><span class="visually-hidden">ShipEngine on LinkedIn</span></a></li></ul></div></nav><p class="footer_copyright__2o-gO"> 2019 Shipengine. All rights reserved</p></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/docs/implementation","query":{},"buildId":"YFMKh3E4H0mCisCl0fgei","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>