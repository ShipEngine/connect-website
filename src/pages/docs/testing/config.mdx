---
title: Customizing Tests
description: The ShipEngine Connect test suite can be customized to your app
---

Customizing Tests
=========================

You can provide customization for the automated tests that are run with the [`connect test` command](./index.mdx#automated-testing)
using the `connect.config.js` file. This is a JavaScript file that exports the parameters expected by the automated tests.


Global Parameters
---------------------------
The `connect.config.js` file gives you the ability to provide global parameters that are applied to each test in the suite.
These are the parameters available at the global level. Most of these parameters can be overridden with
[test-level parameters](#test-level-parameters) unless otherwise noted.

<Reference>
  <Field name="connectArgs" type="object">
    <DefaultValue>
      An empty `session` unless you provide a `connectArgs` property.
    </DefaultValue>
    <Description>
      An object containing properties with the same names as those your defined in
      your [connection form](./../reference/forms.mdx#connection-form-examples). These will be used to call your
      [`connect`](./../reference/methods/connect.mdx) to obtain a valid `session` object before calling other methods in the test.

      If both a `connectArgs` parameter and a `session` parameter are provided, the `session` parameter will be used.
    </Description>
  </Field>

  <Field name="session" type="object">
    <DefaultValue>
      An empty `session` unless you provide a `connectArgs` property.
    </DefaultValue>
    <Description>
      An object containing session information needed to make calls to your backend API or service, such as
      a username and password or an auth token.

      The data included in this object depends on your service. You will need to
      provide the information your methods need to make calls without calling your [`connect`](./../reference/methods/connect.mdx)
      method.

      If both a `connectArgs` parameter and a `session` parameter are provided, the `session` parameter will be used.
    </Description>
  </Field>

  <Field name="failFast" type="boolean">
    <DefaultValue>`false`</DefaultValue>
    <Description>
      Indicates whether or not the test suite should stop execution as soon as the first test failures is encountered.


      This parameter is only available as a global parameter and cannot be overridden by a test.
    </Description>
  </Field>

  <Field name="retries" type="number">
    <DefaultValue>`0`</DefaultValue>
    <Description>The number of times to retry failed tests.</Description>
  </Field>

  <Field name="timeout" type="number">
    <DefaultValue>`2000`</DefaultValue>
    <Description>The number of milliseconds to wait on an asynchronous call before timing out.</Description>
  </Field>
</Reference>


### Example
This is an example of providing global parameters in your `connect.config.js` file.

```javascript
module.exports = {
    connectArgs: {
      account_email: 'user@example.com',
      account_password: 'u0G#^08Ue1G!jX$mkc1',
      agree_to_eula: true,
    },
    timeout: 3000,
    debug: true,
    retries: 1,
    failFast: true
}
```


Test-Level Parameters
------------------------------
The `connect.config.js` file supports overriding the default parameter values for individual tests as well
as [overriding global parameters](#overriding-global-parameters).

Refer to the list of tests for [Carrier Apps](../carrier-app/tests/index.mdx) and [Order Apps](../order-app/tests/index.mdx) to see all the parameters that are available to override for each test.

### Example
This is an example of providing test-level parameters. Notice that we also provide the `connectArgs` parameter at the global
level so that it can be used by all tests.

```javascript
module.exports = {
    connectArgs: {
      account_email: 'user@example.com',
      account_password: 'u0G#^08Ue1G!jX$mkc1',
      agree_to_eula: true,
    },
    tests: {
      createShipment_domestic: [
      {
        deliveryServiceName: `International Economy`,
        label: {
          size: 'A4',
          format: 'pdf',
        },
        shipFrom: {
          name: 'John Doe',
          phoneNumber: '111-111-1111',
          company: 'Example Corp.',
          addressLines: [
           '4009 Marathon Blvd',
           'Suite 300'
          ],
          cityLocality: 'Austin',
          stateProvince: 'TX',
          postalCode: '78756',
          country: 'US',
          isResidential: false
        },
        shipTo: {
          name: 'Amanda Miller',
          phoneNumber: '555-555-5555',
          addressLines: [
            '525 S Winchester Blvd'
          ],
          cityLocality: 'San Jose',
          stateProvince: 'CA',
          postalCode: '95128',
          country: 'US',
          isResidential: true
        },
        weight: {
          value: 10,
          unit: 'lb',
        },
        shipDateTime: '2020-04-15T12:00:00-05:00',
        deliveryConfirmationName: 'Adult Signature'
      }
    ]
  }
}
```


Overriding Global Parameters
-----------------------------------
The `connnect.config.js` file allows you to override the global parameters with test-level parameters.
For example, you may wish to set a longer `timeout` parameter for a test known to take longer.

The following [global parameters](#global-parameters) may be overwritten by test-level parameters.

<Reference>
  <Field name="connectArgs" type="object">
    <DefaultValue>
      An empty `session` unless you provide a `connectArgs` property.
    </DefaultValue>
    <Description>
      An object containing properties with the same names as those your defined in
      your [connection form](./../reference/forms.mdx#connection-form-examples). These will be used to call your
      [`connect`](./../reference/methods/connect.mdx) to obtain a valid `session` object before calling other methods in the test.

      If both a `connectArgs` parameter and a `session` parameter are provided, the `session` parameter will be used.
    </Description>
  </Field>

  <Field name="session" type="object">
    <DefaultValue>
      An empty `session` unless you provide a `connectArgs` property.
    </DefaultValue>
    <Description>
      An object containing session information needed to make calls to your backend API or service, such as
      a username and password or an auth token.

      The data included in this object depends on your service. You will need to
      provide the information your methods need to make calls without calling your [`connect`](./../reference/methods/connect.mdx)
      method.

      If both a `connectArgs` parameter and a `session` parameter are provided, the `session` parameter will be used.
    </Description>
  </Field>

  <Field name="retries" type="number">
    <DefaultValue>`0`</DefaultValue>
    <Description>The number of times to retry failed tests.</Description>
  </Field>

  <Field name="timeout" type="number">
    <DefaultValue>`2000`</DefaultValue>
    <Description>The number of milliseconds to wait on an asynchronous call before timing out.</Description>
  </Field>
</Reference>


### Example
This is an example of overriding global parameters in the `createShipment_domestic` test.

```javascript
module.exports = {
    connectArgs: {
      account_email: 'user@example.com',
      account_password: 'u0G#^08Ue1G!jX$mkc1',
      agree_to_eula: true,
    },
    timeout: 3000,
    debug: true,
    retries: 1,
    failFast: true
    tests: {
      createShipment_domestic: [
      {
        timeout: 4000
      }
    ]
  }
}
```


Providing Multiple Parameter Sets
--------------------------------------------
The `connect.config.js` file supports providing multiple sets of parameters for a single test.  In this case, the test will be
run once for each set of parameters. This gives you the ability to extend the cases covered by our automated test suite to cover other business use cases.

### Example
This is an example of a `connect.config.js` file that provides multiple parameters to the [`createShipment_domestic` test](../carrier-app/tests/create-shipment-domestic.mdx).


The first two sets of parameters provide values for all possible parameters. The last three sets of parameters only provide the
`weight` parameter, and default values will be used for those not provided.

This allows you to conveniently specify the parameters that are relevant to the business logic you are trying to test without forcing you to provide values
for everything else.

Note that when you provide one or more parameter sets that the test runner skips running the test with the default values.

```javascript
module.exports = {
    connectArgs: {
      account_email: 'user@example.com',
      account_password: 'u0G#^08Ue1G!jX$mkc1',
      agree_to_eula: true,
    },
    tests: {
      createShipment_domestic: [
      // First test run, providing all parameters
      {
        deliveryServiceName: `International Economy`,
        label: {
          size: 'A4',
          format: 'pdf',
        },
        shipFrom: {
            name: 'John Doe',
            phoneNumber: '111-111-1111',
          company: 'Example Corp.',
            addressLines: [
           '4009 Marathon Blvd',
           'Suite 300'
              ],
              cityLocality: 'Austin',
              stateProvince: 'TX',
              postalCode: '78756',
              country: 'US',
              isResidential: false
            },
          shipTo: {
            name: 'Amanda Miller',
              phoneNumber: '555-555-5555',
              addressLines: [
                '525 S Winchester Blvd'
              ],
              cityLocality: 'San Jose',
              stateProvince: 'CA',
              postalCode: '95128',
              country: 'US',
              isResidential: true
          },
        weight: {
          value: 10,
          unit: 'lb',
        },
        shipDateTime: '2020-04-15T12:00:00-05:00',
        deliveryConfirmationName: 'Adult Signature'
      },
      // Second test run, providing all parameters
      {
        deliveryServiceName: `International Economy`,
        label: {
          size: '4x6',
          format: 'zpl',
        },
        shipFrom: {
            name: 'John Doe',
            phoneNumber: '111-111-1111',
          company: 'Example Corp.',
            addressLines: [
           '4009 Marathon Blvd',
           'Suite 300'
              ],
              cityLocality: 'Austin',
              stateProvince: 'TX',
              postalCode: '78756',
              country: 'US',
              isResidential: false
            },
          shipTo: {
            name: 'Amanda Miller',
              phoneNumber: '555-555-5555',
              addressLines: [
                '525 S Winchester Blvd'
              ],
              cityLocality: 'San Jose',
              stateProvince: 'CA',
              postalCode: '95128',
              country: 'US',
              isResidential: true
          },
        weight: {
          value: 10,
          unit: 'lb',
        },
        shipDateTime: '2020-04-15T12:00:00-05:00',
        deliveryConfirmationName: 'Adult Signature'
      },
    // Third test run using a custom 'weight' parameter with defaults for the others.
      {
          weight: {
          value: 10,
          unit: 'lb',
        }
      },
        // Fourth test run using a custom 'weight' parameter with defaults for the others.
      {
        weight: {
          value: 10,
          unit: 'lb',
         }
      },
        // Fifth test run using a custom 'weight' parameter with defaults for the others.
      {
        weight: {
          value: 10,
          unit: 'lb',
        }
      }
    ]
    }
  }
```

### Output
This is the output from running the `connect test` command using the example `connect.config.js` file above. You can see that there
are five test runs for the `createShipment_domestic` test, one for each of the parameter sets we provided. In this case, it skips running with the default parameters. For the other tests,
you can see that they were each run only once. These test runs used the default parameters since we did not provide any
parameters for those tests in `connect.config.js`.

![Test output screenshot](/img/testing/connect-test-output.png)


Negative Testing and Errors
-------------------------------------------
Each test supports an `expectedErrorMessage` parameter. This allows you to provide invalid data, such a `weight` parameter
that is out of range for the specified `deliveryService`, and assert that the expected error message is returned.

### Example

This is an example of providing an `expectedErrorMessage` parameter.

```javascript
module.exports = {
    connectArgs: {
      account_email: 'user@example.com',
      account_password: 'u0G#^08Ue1G!jX$mkc1',
      agree_to_eula: true,
    },
    tests: {
      createShipment_domestic: [
      {
        weight: {
        value: 10000,
      unit: 'lb'
    },
    deliveryServiceName: 'Economy',
    expectedErrorMessage: 'The Economy delivery service is only available for packages under 100 pounds.'
    }
    ]
  }
}
```
